/* entitas.c generated by valac 0.34.7, the Vala compiler
 * generated from entitas.gs, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <SDL.h>


#define ENTITAS_TYPE_ENTITY (entitas_entity_get_type ())

#define ENTITAS_TYPE_BACKGROUND (entitas_background_get_type ())
typedef struct _entitasBackground entitasBackground;

#define ENTITAS_TYPE_BOUNDS (entitas_bounds_get_type ())
typedef struct _entitasBounds entitasBounds;

#define ENTITAS_TYPE_BULLET (entitas_bullet_get_type ())
typedef struct _entitasBullet entitasBullet;

#define ENTITAS_TYPE_ENEMY1 (entitas_enemy1_get_type ())
typedef struct _entitasEnemy1 entitasEnemy1;

#define ENTITAS_TYPE_ENEMY2 (entitas_enemy2_get_type ())
typedef struct _entitasEnemy2 entitasEnemy2;

#define ENTITAS_TYPE_ENEMY3 (entitas_enemy3_get_type ())
typedef struct _entitasEnemy3 entitasEnemy3;

#define ENTITAS_TYPE_EXPIRES (entitas_expires_get_type ())
typedef struct _entitasExpires entitasExpires;

#define ENTITAS_TYPE_HEALTH (entitas_health_get_type ())
typedef struct _entitasHealth entitasHealth;

#define ENTITAS_TYPE_HUD (entitas_hud_get_type ())
typedef struct _entitasHud entitasHud;

#define ENTITAS_TYPE_INDEX (entitas_index_get_type ())
typedef struct _entitasIndex entitasIndex;

#define ENTITAS_TYPE_LAYER (entitas_layer_get_type ())
typedef struct _entitasLayer entitasLayer;

#define ENTITAS_TYPE_POSITION (entitas_position_get_type ())
typedef struct _entitasPosition entitasPosition;

#define ENTITAS_TYPE_SCALE (entitas_scale_get_type ())
typedef struct _entitasScale entitasScale;

#define ENTITAS_TYPE_SPRITE (entitas_sprite_get_type ())
typedef struct _entitasSprite entitasSprite;

#define ENTITAS_TYPE_TEXT (entitas_text_get_type ())
typedef struct _entitasText entitasText;

#define ENTITAS_TYPE_TINT (entitas_tint_get_type ())
typedef struct _entitasTint entitasTint;

#define ENTITAS_TYPE_TWEEN (entitas_tween_get_type ())
typedef struct _entitasTween entitasTween;

#define ENTITAS_TYPE_VELOCITY (entitas_velocity_get_type ())
typedef struct _entitasVelocity entitasVelocity;
typedef struct _entitasEntity entitasEntity;

#define ENTITAS_TYPE_BUFFER (entitas_buffer_get_type ())
typedef struct _entitasBuffer entitasBuffer;
typedef struct _entitasGroup entitasGroup;
typedef struct _entitasMatcher entitasMatcher;
#define _g_list_free0(var) ((var == NULL) ? NULL : (var = (g_list_free (var), NULL)))

#define ENTITAS_TYPE_COMPONENTS (entitas_components_get_type ())
#define _g_free0(var) (var = (g_free (var), NULL))
#define _entitas_matcher_free0(var) ((var == NULL) ? NULL : (var = (entitas_matcher_free (var), NULL)))

typedef enum  {
	ENTITAS_EXCEPTION_EntityIsNotEnabled,
	ENTITAS_EXCEPTION_EntityAlreadyHasComponent,
	ENTITAS_EXCEPTION_EntityDoesNotHaveComponent,
	ENTITAS_EXCEPTION_InvalidMatcherExpression,
	ENTITAS_EXCEPTION_EntityIsAlreadyReleased,
	ENTITAS_EXCEPTION_SingleEntity,
	ENTITAS_EXCEPTION_WorldDoesNotContainEntity
} entitasException;
#define ENTITAS_EXCEPTION entitas_exception_quark ()
struct _entitasBackground {
	gboolean active;
};

struct _entitasBounds {
	gint x;
	gint y;
	gint w;
	gint h;
};

struct _entitasBullet {
	gboolean active;
};

struct _entitasEnemy1 {
	gboolean active;
};

struct _entitasEnemy2 {
	gboolean active;
};

struct _entitasEnemy3 {
	gboolean active;
};

struct _entitasExpires {
	gdouble value;
};

struct _entitasHealth {
	gdouble current;
	gdouble maximum;
};

struct _entitasHud {
	gboolean active;
};

struct _entitasIndex {
	gint value;
};

struct _entitasLayer {
	gint value;
};

struct _entitasPosition {
	gdouble x;
	gdouble y;
};

struct _entitasScale {
	gdouble x;
	gdouble y;
};

struct _entitasSprite {
	SDL_Surface* surface;
};

struct _entitasText {
	gchar* text;
	SDL_Surface* surface;
};

struct _entitasTint {
	gint r;
	gint g;
	gint b;
	gint a;
};

struct _entitasTween {
	gdouble min;
	gdouble max;
	gdouble speed;
	gboolean repeat;
	gboolean active;
};

struct _entitasVelocity {
	gdouble x;
	gdouble y;
};

struct _entitasEntity {
	gint id;
	gchar* name;
	gint pool;
	guint64 mask;
	entitasBackground* background;
	entitasBounds* bounds;
	entitasBullet* bullet;
	entitasEnemy1* enemy1;
	entitasEnemy2* enemy2;
	entitasEnemy3* enemy3;
	entitasExpires* expires;
	entitasHealth* health;
	entitasHud* hud;
	entitasIndex* index;
	entitasLayer* layer;
	entitasPosition* position;
	entitasScale* scale;
	entitasSprite* sprite;
	entitasText* text;
	entitasTint* tint;
	entitasTween* tween;
	entitasVelocity* velocity;
};

typedef entitasEntity* (*entitasFactory) (void* user_data);
struct _entitasBuffer {
	gint pool;
	gint size;
};

struct _entitasGroup {
	entitasMatcher* matcher;
	GList* entities;
	entitasEntity* singleEntityCache;
};

typedef enum  {
	ENTITAS_COMPONENTS_BackgroundComponent = 1,
	ENTITAS_COMPONENTS_BoundsComponent,
	ENTITAS_COMPONENTS_BulletComponent,
	ENTITAS_COMPONENTS_Enemy1Component,
	ENTITAS_COMPONENTS_Enemy2Component,
	ENTITAS_COMPONENTS_Enemy3Component,
	ENTITAS_COMPONENTS_ExpiresComponent,
	ENTITAS_COMPONENTS_HealthComponent,
	ENTITAS_COMPONENTS_HudComponent,
	ENTITAS_COMPONENTS_IndexComponent,
	ENTITAS_COMPONENTS_LayerComponent,
	ENTITAS_COMPONENTS_PositionComponent,
	ENTITAS_COMPONENTS_ScaleComponent,
	ENTITAS_COMPONENTS_SoundComponent,
	ENTITAS_COMPONENTS_SpriteComponent,
	ENTITAS_COMPONENTS_TextComponent,
	ENTITAS_COMPONENTS_TintComponent,
	ENTITAS_COMPONENTS_TweenComponent,
	ENTITAS_COMPONENTS_VelocityComponent,
	ENTITAS_COMPONENTS_COUNT = 19
} entitasComponents;

struct _entitasMatcher {
	gchar* id;
	gint* allOfIndices;
	gint allOfIndices_length1;
	guint64 allOfMask;
	gint* anyOfIndices;
	gint anyOfIndices_length1;
	guint64 anyOfMask;
	gint* noneOfIndices;
	gint noneOfIndices_length1;
	guint64 noneOfMask;
	gint* indices;
	gint indices_length1;
	gchar* to_stringCache;
};


extern gint entitas_matcher_uniqueId;
gint entitas_matcher_uniqueId = 0;

GQuark entitas_exception_quark (void);
GType entitas_entity_get_type (void) G_GNUC_CONST;
GType entitas_background_get_type (void) G_GNUC_CONST;
entitasBackground* entitas_background_dup (const entitasBackground* self);
void entitas_background_free (entitasBackground* self);
GType entitas_bounds_get_type (void) G_GNUC_CONST;
entitasBounds* entitas_bounds_dup (const entitasBounds* self);
void entitas_bounds_free (entitasBounds* self);
GType entitas_bullet_get_type (void) G_GNUC_CONST;
entitasBullet* entitas_bullet_dup (const entitasBullet* self);
void entitas_bullet_free (entitasBullet* self);
GType entitas_enemy1_get_type (void) G_GNUC_CONST;
entitasEnemy1* entitas_enemy1_dup (const entitasEnemy1* self);
void entitas_enemy1_free (entitasEnemy1* self);
GType entitas_enemy2_get_type (void) G_GNUC_CONST;
entitasEnemy2* entitas_enemy2_dup (const entitasEnemy2* self);
void entitas_enemy2_free (entitasEnemy2* self);
GType entitas_enemy3_get_type (void) G_GNUC_CONST;
entitasEnemy3* entitas_enemy3_dup (const entitasEnemy3* self);
void entitas_enemy3_free (entitasEnemy3* self);
GType entitas_expires_get_type (void) G_GNUC_CONST;
entitasExpires* entitas_expires_dup (const entitasExpires* self);
void entitas_expires_free (entitasExpires* self);
GType entitas_health_get_type (void) G_GNUC_CONST;
entitasHealth* entitas_health_dup (const entitasHealth* self);
void entitas_health_free (entitasHealth* self);
GType entitas_hud_get_type (void) G_GNUC_CONST;
entitasHud* entitas_hud_dup (const entitasHud* self);
void entitas_hud_free (entitasHud* self);
GType entitas_index_get_type (void) G_GNUC_CONST;
entitasIndex* entitas_index_dup (const entitasIndex* self);
void entitas_index_free (entitasIndex* self);
GType entitas_layer_get_type (void) G_GNUC_CONST;
entitasLayer* entitas_layer_dup (const entitasLayer* self);
void entitas_layer_free (entitasLayer* self);
GType entitas_position_get_type (void) G_GNUC_CONST;
entitasPosition* entitas_position_dup (const entitasPosition* self);
void entitas_position_free (entitasPosition* self);
GType entitas_scale_get_type (void) G_GNUC_CONST;
entitasScale* entitas_scale_dup (const entitasScale* self);
void entitas_scale_free (entitasScale* self);
GType entitas_sprite_get_type (void) G_GNUC_CONST;
entitasSprite* entitas_sprite_dup (const entitasSprite* self);
void entitas_sprite_free (entitasSprite* self);
GType entitas_text_get_type (void) G_GNUC_CONST;
entitasText* entitas_text_dup (const entitasText* self);
void entitas_text_free (entitasText* self);
void entitas_text_copy (const entitasText* self, entitasText* dest);
void entitas_text_destroy (entitasText* self);
GType entitas_tint_get_type (void) G_GNUC_CONST;
entitasTint* entitas_tint_dup (const entitasTint* self);
void entitas_tint_free (entitasTint* self);
GType entitas_tween_get_type (void) G_GNUC_CONST;
entitasTween* entitas_tween_dup (const entitasTween* self);
void entitas_tween_free (entitasTween* self);
GType entitas_velocity_get_type (void) G_GNUC_CONST;
entitasVelocity* entitas_velocity_dup (const entitasVelocity* self);
void entitas_velocity_free (entitasVelocity* self);
entitasEntity* entitas_entity_dup (const entitasEntity* self);
void entitas_entity_free (entitasEntity* self);
void entitas_entity_copy (const entitasEntity* self, entitasEntity* dest);
void entitas_entity_destroy (entitasEntity* self);
GType entitas_buffer_get_type (void) G_GNUC_CONST;
entitasBuffer* entitas_buffer_dup (const entitasBuffer* self);
void entitas_buffer_free (entitasBuffer* self);
void entitas_group_free (entitasGroup* self);
void entitas_matcher_free (entitasMatcher* self);
static void entitas_group_instance_init (entitasGroup * self);
entitasGroup* entitas_group_new (entitasMatcher* matcher);
void entitas_group_handleEntitySilently (entitasGroup* self, entitasEntity* entity);
gboolean entitas_matcher_matches (entitasMatcher* self, entitasEntity* entity);
GType entitas_components_get_type (void) G_GNUC_CONST;
void entitas_group_handleEntity (entitasGroup* self, entitasEntity* entity, entitasComponents index);
gboolean entitas_group_containsEntity (entitasGroup* self, entitasEntity* entity);
entitasEntity* entitas_group_getSingleEntity (entitasGroup* self);
gchar* entitas_matcher_to_string (entitasMatcher* self);
static void entitas_matcher_instance_init (entitasMatcher * self);
entitasMatcher* entitas_matcher_new (entitasMatcher** matchers, int matchers_length1);
gint* entitas_matcher_distinctIndices (gint* indices, int indices_length1, int* result_length1);
gint* entitas_matcher_listToArray (GList* l, int* result_length1);
gint* entitas_matcher_getIndices (entitasMatcher* self, int* result_length1);
gint* entitas_matcher_mergeIndices (entitasMatcher* self, int* result_length1);
static gint* _vala_array_dup1 (gint* self, int length);
entitasMatcher* entitas_matcher_anyOf (entitasMatcher* self, gint* args, int args_length1);
entitasMatcher* entitas_matcher_noneOf (entitasMatcher* self, gint* args, int args_length1);
#define ENTITAS___ACTIVE__ ((guint64) 0x8000000000000000LL)
gchar* entitas_matcher_componentsto_string (gint* indexArray, int indexArray_length1);
gint* entitas_matcher_merge (entitasMatcher** matchers, int matchers_length1, int* result_length1, GError** error);
entitasMatcher* entitas_matcher_NoneOf (gint* args, int args_length1);
guint64 entitas_matcher_buildMask (gint* indices, int indices_length1);
entitasMatcher* entitas_matcher_AllOf (gint* args, int args_length1);
entitasMatcher* entitas_matcher_AnyOf (gint* args, int args_length1);

extern const gchar* ENTITAS_ComponentString[20];
const guint64 ENTITAS___POW2__[65] = {(guint64) 0x0000000000000000, (guint64) 0x0000000000000001, (guint64) 0x0000000000000002, (guint64) 0x0000000000000004, (guint64) 0x0000000000000008, (guint64) 0x0000000000000010, (guint64) 0x0000000000000020, (guint64) 0x0000000000000040, (guint64) 0x0000000000000080, (guint64) 0x0000000000000100, (guint64) 0x0000000000000200, (guint64) 0x0000000000000400, (guint64) 0x0000000000000800, (guint64) 0x0000000000001000, (guint64) 0x0000000000002000, (guint64) 0x0000000000004000, (guint64) 0x0000000000008000, (guint64) 0x0000000000010000, (guint64) 0x0000000000020000, (guint64) 0x0000000000040000, (guint64) 0x0000000000080000, (guint64) 0x0000000000100000, (guint64) 0x0000000000200000, (guint64) 0x0000000000400000, (guint64) 0x0000000000800000, (guint64) 0x0000000001000000, (guint64) 0x0000000002000000, (guint64) 0x0000000004000000, (guint64) 0x0000000008000000, (guint64) 0x0000000010000000, (guint64) 0x0000000020000000, (guint64) 0x0000000040000000, (guint64) 0x0000000080000000LL, (guint64) 0x0000000100000000LL, (guint64) 0x0000000200000000LL, (guint64) 0x0000000400000000LL, (guint64) 0x0000000800000000LL, (guint64) 0x0000001000000000LL, (guint64) 0x0000002000000000LL, (guint64) 0x0000004000000000LL, (guint64) 0x0000008000000000LL, (guint64) 0x0000010000000000LL, (guint64) 0x0000020000000000LL, (guint64) 0x0000040000000000LL, (guint64) 0x0000080000000000LL, (guint64) 0x0000100000000000LL, (guint64) 0x0000200000000000LL, (guint64) 0x0000400000000000LL, (guint64) 0x0000800000000000LL, (guint64) 0x0001000000000000LL, (guint64) 0x0002000000000000LL, (guint64) 0x0004000000000000LL, (guint64) 0x0008000000000000LL, (guint64) 0x0010000000000000LL, (guint64) 0x0020000000000000LL, (guint64) 0x0040000000000000LL, (guint64) 0x0080000000000000LL, (guint64) 0x0100000000000000LL, (guint64) 0x0200000000000000LL, (guint64) 0x0400000000000000LL, (guint64) 0x0800000000000000LL, (guint64) 0x1000000000000000LL, (guint64) 0x2000000000000000LL, (guint64) 0x4000000000000000LL, (guint64) 0x8000000000000000LL};

GQuark entitas_exception_quark (void) {
	return g_quark_from_static_string ("entitas_exception-quark");
}


entitasBuffer* entitas_buffer_dup (const entitasBuffer* self) {
	entitasBuffer* dup;
	dup = g_new0 (entitasBuffer, 1);
	memcpy (dup, self, sizeof (entitasBuffer));
	return dup;
}


void entitas_buffer_free (entitasBuffer* self) {
	g_free (self);
}


GType entitas_buffer_get_type (void) {
	static volatile gsize entitas_buffer_type_id__volatile = 0;
	if (g_once_init_enter (&entitas_buffer_type_id__volatile)) {
		GType entitas_buffer_type_id;
		entitas_buffer_type_id = g_boxed_type_register_static ("entitasBuffer", (GBoxedCopyFunc) entitas_buffer_dup, (GBoxedFreeFunc) entitas_buffer_free);
		g_once_init_leave (&entitas_buffer_type_id__volatile, entitas_buffer_type_id);
	}
	return entitas_buffer_type_id__volatile;
}


entitasGroup* entitas_group_new (entitasMatcher* matcher) {
	entitasGroup* self;
	entitasMatcher* _tmp0_ = NULL;
	g_return_val_if_fail (matcher != NULL, NULL);
	self = g_slice_new0 (entitasGroup);
	entitas_group_instance_init (self);
	_tmp0_ = matcher;
	self->matcher = _tmp0_;
	return self;
}


/** Add entity to group */
void entitas_group_handleEntitySilently (entitasGroup* self, entitasEntity* entity) {
	entitasMatcher* _tmp0_ = NULL;
	entitasEntity* _tmp1_ = NULL;
	gboolean _tmp2_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->matcher;
	_tmp1_ = entity;
	_tmp2_ = entitas_matcher_matches (_tmp0_, _tmp1_);
	if (_tmp2_) {
		entitasEntity* _tmp3_ = NULL;
		_tmp3_ = entity;
		self->entities = g_list_append (self->entities, _tmp3_);
	} else {
		entitasEntity* _tmp4_ = NULL;
		_tmp4_ = entity;
		self->entities = g_list_remove (self->entities, _tmp4_);
	}
}


/** Add entity to group and raise events */
void entitas_group_handleEntity (entitasGroup* self, entitasEntity* entity, entitasComponents index) {
	entitasMatcher* _tmp0_ = NULL;
	entitasEntity* _tmp1_ = NULL;
	gboolean _tmp2_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->matcher;
	_tmp1_ = entity;
	_tmp2_ = entitas_matcher_matches (_tmp0_, _tmp1_);
	if (_tmp2_) {
		entitasEntity* _tmp3_ = NULL;
		_tmp3_ = entity;
		self->entities = g_list_append (self->entities, _tmp3_);
	} else {
		entitasEntity* _tmp4_ = NULL;
		_tmp4_ = entity;
		self->entities = g_list_remove (self->entities, _tmp4_);
	}
}


gboolean entitas_group_containsEntity (entitasGroup* self, entitasEntity* entity) {
	gboolean result = FALSE;
	GList* _tmp0_ = NULL;
	entitasEntity* _tmp1_ = NULL;
	GList* _tmp2_ = NULL;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = self->entities;
	_tmp1_ = entity;
	_tmp2_ = g_list_find (_tmp0_, _tmp1_);
	result = _tmp2_ != NULL;
	return result;
}


entitasEntity* entitas_group_getSingleEntity (entitasGroup* self) {
	entitasEntity* result = NULL;
	guint c = 0U;
	GList* _tmp0_ = NULL;
	guint _tmp1_ = 0U;
	guint _tmp2_ = 0U;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->entities;
	_tmp1_ = g_list_length (_tmp0_);
	c = _tmp1_;
	_tmp2_ = c;
	if (_tmp2_ == ((guint) 1)) {
		GList* _tmp3_ = NULL;
		GList* _tmp4_ = NULL;
		gconstpointer _tmp5_ = NULL;
		_tmp3_ = self->entities;
		_tmp4_ = g_list_first (_tmp3_);
		_tmp5_ = _tmp4_->data;
		result = (entitasEntity*) _tmp5_;
		return result;
	} else {
		guint _tmp6_ = 0U;
		_tmp6_ = c;
		if (_tmp6_ == ((guint) 0)) {
			result = NULL;
			return result;
		} else {
			entitasMatcher* _tmp7_ = NULL;
			gchar* _tmp8_ = NULL;
			gchar* _tmp9_ = NULL;
			GError* _tmp10_ = NULL;
			GError* _tmp11_ = NULL;
			_tmp7_ = self->matcher;
			_tmp8_ = entitas_matcher_to_string (_tmp7_);
			_tmp9_ = _tmp8_;
			_tmp10_ = g_error_new_literal (ENTITAS_EXCEPTION, ENTITAS_EXCEPTION_SingleEntity, _tmp9_);
			_tmp11_ = _tmp10_;
			_g_free0 (_tmp9_);
			_inner_error_ = _tmp11_;
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
	}
}


static void entitas_group_instance_init (entitasGroup * self) {
	self->entities = NULL;
}


void entitas_group_free (entitasGroup* self) {
	_g_list_free0 (self->entities);
	g_slice_free (entitasGroup, self);
}


/**
 *  clone/merge 1 or more existing matchers
 */
entitasMatcher* entitas_matcher_new (entitasMatcher** matchers, int matchers_length1) {
	entitasMatcher* self;
	gint _tmp0_ = 0;
	gchar* _tmp1_ = NULL;
	entitasMatcher** _tmp2_ = NULL;
	gint _tmp2__length1 = 0;
	self = g_slice_new0 (entitasMatcher);
	entitas_matcher_instance_init (self);
	_tmp0_ = entitas_matcher_uniqueId;
	entitas_matcher_uniqueId = _tmp0_ + 1;
	_tmp1_ = g_strdup_printf ("%i", _tmp0_);
	_g_free0 (self->id);
	self->id = _tmp1_;
	_tmp2_ = matchers;
	_tmp2__length1 = matchers_length1;
	if (_tmp2_ != NULL) {
		GList* allOf = NULL;
		GList* anyOf = NULL;
		GList* noneOf = NULL;
		GList* _tmp36_ = NULL;
		gint _tmp37_ = 0;
		gint* _tmp38_ = NULL;
		gint* _tmp39_ = NULL;
		gint _tmp39__length1 = 0;
		gint _tmp40_ = 0;
		gint* _tmp41_ = NULL;
		GList* _tmp42_ = NULL;
		gint _tmp43_ = 0;
		gint* _tmp44_ = NULL;
		gint* _tmp45_ = NULL;
		gint _tmp45__length1 = 0;
		gint _tmp46_ = 0;
		gint* _tmp47_ = NULL;
		GList* _tmp48_ = NULL;
		gint _tmp49_ = 0;
		gint* _tmp50_ = NULL;
		gint* _tmp51_ = NULL;
		gint _tmp51__length1 = 0;
		gint _tmp52_ = 0;
		gint* _tmp53_ = NULL;
		allOf = NULL;
		anyOf = NULL;
		noneOf = NULL;
		{
			gint i = 0;
			i = 0;
			{
				gboolean _tmp3_ = FALSE;
				_tmp3_ = TRUE;
				while (TRUE) {
					entitasMatcher** _tmp5_ = NULL;
					gint _tmp5__length1 = 0;
					guint64 _tmp6_ = 0ULL;
					entitasMatcher** _tmp7_ = NULL;
					gint _tmp7__length1 = 0;
					gint _tmp8_ = 0;
					entitasMatcher* _tmp9_ = NULL;
					guint64 _tmp10_ = 0ULL;
					guint64 _tmp11_ = 0ULL;
					entitasMatcher** _tmp12_ = NULL;
					gint _tmp12__length1 = 0;
					gint _tmp13_ = 0;
					entitasMatcher* _tmp14_ = NULL;
					guint64 _tmp15_ = 0ULL;
					guint64 _tmp16_ = 0ULL;
					entitasMatcher** _tmp17_ = NULL;
					gint _tmp17__length1 = 0;
					gint _tmp18_ = 0;
					entitasMatcher* _tmp19_ = NULL;
					guint64 _tmp20_ = 0ULL;
					entitasMatcher** _tmp21_ = NULL;
					gint _tmp21__length1 = 0;
					gint _tmp22_ = 0;
					entitasMatcher* _tmp23_ = NULL;
					gint* _tmp24_ = NULL;
					gint _tmp24__length1 = 0;
					entitasMatcher** _tmp26_ = NULL;
					gint _tmp26__length1 = 0;
					gint _tmp27_ = 0;
					entitasMatcher* _tmp28_ = NULL;
					gint* _tmp29_ = NULL;
					gint _tmp29__length1 = 0;
					entitasMatcher** _tmp31_ = NULL;
					gint _tmp31__length1 = 0;
					gint _tmp32_ = 0;
					entitasMatcher* _tmp33_ = NULL;
					gint* _tmp34_ = NULL;
					gint _tmp34__length1 = 0;
					if (!_tmp3_) {
						gint _tmp4_ = 0;
						_tmp4_ = i;
						i = _tmp4_ + 1;
					}
					_tmp3_ = FALSE;
					_tmp5_ = matchers;
					_tmp5__length1 = matchers_length1;
					if (!(i <= (_tmp5__length1 - 1))) {
						break;
					}
					_tmp6_ = self->allOfMask;
					_tmp7_ = matchers;
					_tmp7__length1 = matchers_length1;
					_tmp8_ = i;
					_tmp9_ = _tmp7_[_tmp8_];
					_tmp10_ = _tmp9_->allOfMask;
					self->allOfMask = _tmp6_ | _tmp10_;
					_tmp11_ = self->anyOfMask;
					_tmp12_ = matchers;
					_tmp12__length1 = matchers_length1;
					_tmp13_ = i;
					_tmp14_ = _tmp12_[_tmp13_];
					_tmp15_ = _tmp14_->anyOfMask;
					self->anyOfMask = _tmp11_ | _tmp15_;
					_tmp16_ = self->noneOfMask;
					_tmp17_ = matchers;
					_tmp17__length1 = matchers_length1;
					_tmp18_ = i;
					_tmp19_ = _tmp17_[_tmp18_];
					_tmp20_ = _tmp19_->noneOfMask;
					self->noneOfMask = _tmp16_ | _tmp20_;
					_tmp21_ = matchers;
					_tmp21__length1 = matchers_length1;
					_tmp22_ = i;
					_tmp23_ = _tmp21_[_tmp22_];
					_tmp24_ = _tmp23_->allOfIndices;
					_tmp24__length1 = _tmp23_->allOfIndices_length1;
					{
						gint* j_collection = NULL;
						gint j_collection_length1 = 0;
						gint _j_collection_size_ = 0;
						gint j_it = 0;
						j_collection = _tmp24_;
						j_collection_length1 = _tmp24__length1;
						for (j_it = 0; j_it < _tmp24__length1; j_it = j_it + 1) {
							gint j = 0;
							j = j_collection[j_it];
							{
								gint _tmp25_ = 0;
								_tmp25_ = i;
								allOf = g_list_append (allOf, (gpointer) ((gintptr) _tmp25_));
							}
						}
					}
					_tmp26_ = matchers;
					_tmp26__length1 = matchers_length1;
					_tmp27_ = i;
					_tmp28_ = _tmp26_[_tmp27_];
					_tmp29_ = _tmp28_->anyOfIndices;
					_tmp29__length1 = _tmp28_->anyOfIndices_length1;
					{
						gint* j_collection = NULL;
						gint j_collection_length1 = 0;
						gint _j_collection_size_ = 0;
						gint j_it = 0;
						j_collection = _tmp29_;
						j_collection_length1 = _tmp29__length1;
						for (j_it = 0; j_it < _tmp29__length1; j_it = j_it + 1) {
							gint j = 0;
							j = j_collection[j_it];
							{
								gint _tmp30_ = 0;
								_tmp30_ = i;
								anyOf = g_list_append (anyOf, (gpointer) ((gintptr) _tmp30_));
							}
						}
					}
					_tmp31_ = matchers;
					_tmp31__length1 = matchers_length1;
					_tmp32_ = i;
					_tmp33_ = _tmp31_[_tmp32_];
					_tmp34_ = _tmp33_->noneOfIndices;
					_tmp34__length1 = _tmp33_->noneOfIndices_length1;
					{
						gint* j_collection = NULL;
						gint j_collection_length1 = 0;
						gint _j_collection_size_ = 0;
						gint j_it = 0;
						j_collection = _tmp34_;
						j_collection_length1 = _tmp34__length1;
						for (j_it = 0; j_it < _tmp34__length1; j_it = j_it + 1) {
							gint j = 0;
							j = j_collection[j_it];
							{
								gint _tmp35_ = 0;
								_tmp35_ = i;
								noneOf = g_list_append (noneOf, (gpointer) ((gintptr) _tmp35_));
							}
						}
					}
				}
			}
		}
		_tmp36_ = allOf;
		_tmp38_ = entitas_matcher_listToArray (_tmp36_, &_tmp37_);
		_tmp39_ = _tmp38_;
		_tmp39__length1 = _tmp37_;
		_tmp41_ = entitas_matcher_distinctIndices (_tmp39_, _tmp37_, &_tmp40_);
		self->allOfIndices = (g_free (self->allOfIndices), NULL);
		self->allOfIndices = _tmp41_;
		self->allOfIndices_length1 = _tmp40_;
		_tmp39_ = (g_free (_tmp39_), NULL);
		_tmp42_ = anyOf;
		_tmp44_ = entitas_matcher_listToArray (_tmp42_, &_tmp43_);
		_tmp45_ = _tmp44_;
		_tmp45__length1 = _tmp43_;
		_tmp47_ = entitas_matcher_distinctIndices (_tmp45_, _tmp43_, &_tmp46_);
		self->anyOfIndices = (g_free (self->anyOfIndices), NULL);
		self->anyOfIndices = _tmp47_;
		self->anyOfIndices_length1 = _tmp46_;
		_tmp45_ = (g_free (_tmp45_), NULL);
		_tmp48_ = noneOf;
		_tmp50_ = entitas_matcher_listToArray (_tmp48_, &_tmp49_);
		_tmp51_ = _tmp50_;
		_tmp51__length1 = _tmp49_;
		_tmp53_ = entitas_matcher_distinctIndices (_tmp51_, _tmp49_, &_tmp52_);
		self->noneOfIndices = (g_free (self->noneOfIndices), NULL);
		self->noneOfIndices = _tmp53_;
		self->noneOfIndices_length1 = _tmp52_;
		_tmp51_ = (g_free (_tmp51_), NULL);
		_g_list_free0 (noneOf);
		_g_list_free0 (anyOf);
		_g_list_free0 (allOf);
	}
	return self;
}


/**
 * A list of the component ordinals that this matches
 * @type Array<number>
 * @name entitas.Matcher#indices */
static gint* _vala_array_dup1 (gint* self, int length) {
	return g_memdup (self, length * sizeof (gint));
}


gint* entitas_matcher_getIndices (entitasMatcher* self, int* result_length1) {
	gint* result = NULL;
	gint* _tmp0_ = NULL;
	gint _tmp0__length1 = 0;
	gint* _tmp3_ = NULL;
	gint _tmp3__length1 = 0;
	gint* _tmp4_ = NULL;
	gint _tmp4__length1 = 0;
	gint* _tmp5_ = NULL;
	gint _tmp5__length1 = 0;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->indices;
	_tmp0__length1 = self->indices_length1;
	if (_tmp0_ == NULL) {
		gint _tmp1_ = 0;
		gint* _tmp2_ = NULL;
		_tmp2_ = entitas_matcher_mergeIndices (self, &_tmp1_);
		self->indices = (g_free (self->indices), NULL);
		self->indices = _tmp2_;
		self->indices_length1 = _tmp1_;
	}
	_tmp3_ = self->indices;
	_tmp3__length1 = self->indices_length1;
	_tmp4_ = (_tmp3_ != NULL) ? _vala_array_dup1 (_tmp3_, _tmp3__length1) : ((gpointer) _tmp3_);
	_tmp4__length1 = _tmp3__length1;
	_tmp5_ = _tmp4_;
	_tmp5__length1 = _tmp4__length1;
	if (result_length1) {
		*result_length1 = _tmp5__length1;
	}
	result = _tmp5_;
	return result;
}


/**
 * Matches anyOf the components/indices specified
 * @params Array<entitas.IMatcher>|Array<number> args
 * @returns entitas.Matcher
 */
entitasMatcher* entitas_matcher_anyOf (entitasMatcher* self, gint* args, int args_length1) {
	entitasMatcher* result = NULL;
	gint* _tmp0_ = NULL;
	gint _tmp0__length1 = 0;
	gint _tmp1_ = 0;
	gint* _tmp2_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = args;
	_tmp0__length1 = args_length1;
	_tmp2_ = entitas_matcher_distinctIndices (_tmp0_, _tmp0__length1, &_tmp1_);
	self->anyOfIndices = (g_free (self->anyOfIndices), NULL);
	self->anyOfIndices = _tmp2_;
	self->anyOfIndices_length1 = _tmp1_;
	self->indices = (g_free (self->indices), NULL);
	self->indices = NULL;
	self->indices_length1 = 0;
	result = self;
	return result;
}


/**
 * Matches noneOf the components/indices specified
 * @params Array<entitas.IMatcher>|Array<number> args
 * @returns entitas.Matcher
 */
entitasMatcher* entitas_matcher_noneOf (entitasMatcher* self, gint* args, int args_length1) {
	entitasMatcher* result = NULL;
	gint* _tmp0_ = NULL;
	gint _tmp0__length1 = 0;
	gint _tmp1_ = 0;
	gint* _tmp2_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = args;
	_tmp0__length1 = args_length1;
	_tmp2_ = entitas_matcher_distinctIndices (_tmp0_, _tmp0__length1, &_tmp1_);
	self->noneOfIndices = (g_free (self->noneOfIndices), NULL);
	self->noneOfIndices = _tmp2_;
	self->noneOfIndices_length1 = _tmp1_;
	self->indices = (g_free (self->indices), NULL);
	self->indices = NULL;
	self->indices_length1 = 0;
	result = self;
	return result;
}


/**
 * Check if the entity matches this matcher
 * @param entitas.IEntity entity	
 * @returns boolean
 */
gboolean entitas_matcher_matches (entitasMatcher* self, entitasEntity* entity) {
	gboolean result = FALSE;
	guint64 mask = 0ULL;
	entitasEntity* _tmp0_ = NULL;
	guint64 _tmp1_ = 0ULL;
	gboolean _tmp2_ = FALSE;
	guint64 _tmp3_ = 0ULL;
	gboolean matchesAllOf = FALSE;
	gboolean _tmp7_ = FALSE;
	guint64 _tmp8_ = 0ULL;
	gboolean matchesAnyOf = FALSE;
	gboolean _tmp11_ = FALSE;
	guint64 _tmp12_ = 0ULL;
	gboolean matchesNoneOf = FALSE;
	gboolean _tmp15_ = FALSE;
	gboolean _tmp16_ = FALSE;
	gboolean _tmp17_ = FALSE;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = entity;
	_tmp1_ = (*_tmp0_).mask;
	mask = _tmp1_ ^ ENTITAS___ACTIVE__;
	_tmp3_ = self->allOfMask;
	if (_tmp3_ == ((guint64) 0)) {
		_tmp2_ = TRUE;
	} else {
		guint64 _tmp4_ = 0ULL;
		guint64 _tmp5_ = 0ULL;
		guint64 _tmp6_ = 0ULL;
		_tmp4_ = mask;
		_tmp5_ = self->allOfMask;
		_tmp6_ = self->allOfMask;
		_tmp2_ = (_tmp4_ & _tmp5_) == _tmp6_;
	}
	matchesAllOf = _tmp2_;
	_tmp8_ = self->anyOfMask;
	if (_tmp8_ == ((guint64) 0)) {
		_tmp7_ = TRUE;
	} else {
		guint64 _tmp9_ = 0ULL;
		guint64 _tmp10_ = 0ULL;
		_tmp9_ = mask;
		_tmp10_ = self->anyOfMask;
		_tmp7_ = (_tmp9_ & _tmp10_) != ((guint64) 0);
	}
	matchesAnyOf = _tmp7_;
	_tmp12_ = self->noneOfMask;
	if (_tmp12_ == ((guint64) 0)) {
		_tmp11_ = TRUE;
	} else {
		guint64 _tmp13_ = 0ULL;
		guint64 _tmp14_ = 0ULL;
		_tmp13_ = mask;
		_tmp14_ = self->noneOfMask;
		_tmp11_ = (_tmp13_ & _tmp14_) == ((guint64) 0);
	}
	matchesNoneOf = _tmp11_;
	_tmp17_ = matchesAllOf;
	if (_tmp17_) {
		gboolean _tmp18_ = FALSE;
		_tmp18_ = matchesAnyOf;
		_tmp16_ = _tmp18_;
	} else {
		_tmp16_ = FALSE;
	}
	if (_tmp16_) {
		gboolean _tmp19_ = FALSE;
		_tmp19_ = matchesNoneOf;
		_tmp15_ = _tmp19_;
	} else {
		_tmp15_ = FALSE;
	}
	result = _tmp15_;
	return result;
}


/**
 * Merge list of component indices
 * @returns Array<number>
 */
gint* entitas_matcher_mergeIndices (entitasMatcher* self, int* result_length1) {
	gint* result = NULL;
	GList* indicesList = NULL;
	gint* _tmp0_ = NULL;
	gint _tmp0__length1 = 0;
	gint* _tmp3_ = NULL;
	gint _tmp3__length1 = 0;
	gint* _tmp6_ = NULL;
	gint _tmp6__length1 = 0;
	GList* _tmp9_ = NULL;
	gint _tmp10_ = 0;
	gint* _tmp11_ = NULL;
	gint* _tmp12_ = NULL;
	gint _tmp12__length1 = 0;
	gint _tmp13_ = 0;
	gint* _tmp14_ = NULL;
	gint* _tmp15_ = NULL;
	gint _tmp15__length1 = 0;
	gint* _tmp16_ = NULL;
	gint _tmp16__length1 = 0;
	g_return_val_if_fail (self != NULL, NULL);
	indicesList = NULL;
	_tmp0_ = self->allOfIndices;
	_tmp0__length1 = self->allOfIndices_length1;
	if (_tmp0_ != NULL) {
		gint* _tmp1_ = NULL;
		gint _tmp1__length1 = 0;
		_tmp1_ = self->allOfIndices;
		_tmp1__length1 = self->allOfIndices_length1;
		{
			gint* i_collection = NULL;
			gint i_collection_length1 = 0;
			gint _i_collection_size_ = 0;
			gint i_it = 0;
			i_collection = _tmp1_;
			i_collection_length1 = _tmp1__length1;
			for (i_it = 0; i_it < _tmp1__length1; i_it = i_it + 1) {
				gint i = 0;
				i = i_collection[i_it];
				{
					gint _tmp2_ = 0;
					_tmp2_ = i;
					indicesList = g_list_append (indicesList, (gpointer) ((gintptr) _tmp2_));
				}
			}
		}
	}
	_tmp3_ = self->anyOfIndices;
	_tmp3__length1 = self->anyOfIndices_length1;
	if (_tmp3_ != NULL) {
		gint* _tmp4_ = NULL;
		gint _tmp4__length1 = 0;
		_tmp4_ = self->anyOfIndices;
		_tmp4__length1 = self->anyOfIndices_length1;
		{
			gint* i_collection = NULL;
			gint i_collection_length1 = 0;
			gint _i_collection_size_ = 0;
			gint i_it = 0;
			i_collection = _tmp4_;
			i_collection_length1 = _tmp4__length1;
			for (i_it = 0; i_it < _tmp4__length1; i_it = i_it + 1) {
				gint i = 0;
				i = i_collection[i_it];
				{
					gint _tmp5_ = 0;
					_tmp5_ = i;
					indicesList = g_list_append (indicesList, (gpointer) ((gintptr) _tmp5_));
				}
			}
		}
	}
	_tmp6_ = self->noneOfIndices;
	_tmp6__length1 = self->noneOfIndices_length1;
	if (_tmp6_ != NULL) {
		gint* _tmp7_ = NULL;
		gint _tmp7__length1 = 0;
		_tmp7_ = self->noneOfIndices;
		_tmp7__length1 = self->noneOfIndices_length1;
		{
			gint* i_collection = NULL;
			gint i_collection_length1 = 0;
			gint _i_collection_size_ = 0;
			gint i_it = 0;
			i_collection = _tmp7_;
			i_collection_length1 = _tmp7__length1;
			for (i_it = 0; i_it < _tmp7__length1; i_it = i_it + 1) {
				gint i = 0;
				i = i_collection[i_it];
				{
					gint _tmp8_ = 0;
					_tmp8_ = i;
					indicesList = g_list_append (indicesList, (gpointer) ((gintptr) _tmp8_));
				}
			}
		}
	}
	_tmp9_ = indicesList;
	_tmp11_ = entitas_matcher_listToArray (_tmp9_, &_tmp10_);
	_tmp12_ = _tmp11_;
	_tmp12__length1 = _tmp10_;
	_tmp14_ = entitas_matcher_distinctIndices (_tmp12_, _tmp10_, &_tmp13_);
	_tmp15_ = _tmp14_;
	_tmp15__length1 = _tmp13_;
	_tmp12_ = (g_free (_tmp12_), NULL);
	_tmp16_ = _tmp15_;
	_tmp16__length1 = _tmp15__length1;
	if (result_length1) {
		*result_length1 = _tmp16__length1;
	}
	result = _tmp16_;
	_g_list_free0 (indicesList);
	return result;
}


/**
 * to_string representation of this matcher
 * @returns string
 */
gchar* entitas_matcher_to_string (entitasMatcher* self) {
	gchar* result = NULL;
	const gchar* _tmp0_ = NULL;
	const gchar* _tmp37_ = NULL;
	gchar* _tmp38_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->to_stringCache;
	if (_tmp0_ == NULL) {
		gchar* sb = NULL;
		gchar* _tmp1_ = NULL;
		gint* _tmp2_ = NULL;
		gint _tmp2__length1 = 0;
		gint* _tmp12_ = NULL;
		gint _tmp12__length1 = 0;
		gint* _tmp25_ = NULL;
		gint _tmp25__length1 = 0;
		const gchar* _tmp35_ = NULL;
		gchar* _tmp36_ = NULL;
		_tmp1_ = g_strdup ("");
		sb = _tmp1_;
		_tmp2_ = self->allOfIndices;
		_tmp2__length1 = self->allOfIndices_length1;
		if (_tmp2_ != NULL) {
			const gchar* _tmp3_ = NULL;
			gchar* _tmp4_ = NULL;
			const gchar* _tmp5_ = NULL;
			gint* _tmp6_ = NULL;
			gint _tmp6__length1 = 0;
			gchar* _tmp7_ = NULL;
			gchar* _tmp8_ = NULL;
			gchar* _tmp9_ = NULL;
			const gchar* _tmp10_ = NULL;
			gchar* _tmp11_ = NULL;
			_tmp3_ = sb;
			_tmp4_ = g_strconcat (_tmp3_, "AllOf(", NULL);
			_g_free0 (sb);
			sb = _tmp4_;
			_tmp5_ = sb;
			_tmp6_ = self->allOfIndices;
			_tmp6__length1 = self->allOfIndices_length1;
			_tmp7_ = entitas_matcher_componentsto_string (_tmp6_, _tmp6__length1);
			_tmp8_ = _tmp7_;
			_tmp9_ = g_strconcat (_tmp5_, _tmp8_, NULL);
			_g_free0 (sb);
			sb = _tmp9_;
			_g_free0 (_tmp8_);
			_tmp10_ = sb;
			_tmp11_ = g_strconcat (_tmp10_, ")", NULL);
			_g_free0 (sb);
			sb = _tmp11_;
		}
		_tmp12_ = self->anyOfIndices;
		_tmp12__length1 = self->anyOfIndices_length1;
		if (_tmp12_ != NULL) {
			gint* _tmp13_ = NULL;
			gint _tmp13__length1 = 0;
			const gchar* _tmp16_ = NULL;
			gchar* _tmp17_ = NULL;
			const gchar* _tmp18_ = NULL;
			gint* _tmp19_ = NULL;
			gint _tmp19__length1 = 0;
			gchar* _tmp20_ = NULL;
			gchar* _tmp21_ = NULL;
			gchar* _tmp22_ = NULL;
			const gchar* _tmp23_ = NULL;
			gchar* _tmp24_ = NULL;
			_tmp13_ = self->allOfIndices;
			_tmp13__length1 = self->allOfIndices_length1;
			if (_tmp13_ != NULL) {
				const gchar* _tmp14_ = NULL;
				gchar* _tmp15_ = NULL;
				_tmp14_ = sb;
				_tmp15_ = g_strconcat (_tmp14_, ".", NULL);
				_g_free0 (sb);
				sb = _tmp15_;
			}
			_tmp16_ = sb;
			_tmp17_ = g_strconcat (_tmp16_, "AnyOf(", NULL);
			_g_free0 (sb);
			sb = _tmp17_;
			_tmp18_ = sb;
			_tmp19_ = self->anyOfIndices;
			_tmp19__length1 = self->anyOfIndices_length1;
			_tmp20_ = entitas_matcher_componentsto_string (_tmp19_, _tmp19__length1);
			_tmp21_ = _tmp20_;
			_tmp22_ = g_strconcat (_tmp18_, _tmp21_, NULL);
			_g_free0 (sb);
			sb = _tmp22_;
			_g_free0 (_tmp21_);
			_tmp23_ = sb;
			_tmp24_ = g_strconcat (_tmp23_, ")", NULL);
			_g_free0 (sb);
			sb = _tmp24_;
		}
		_tmp25_ = self->noneOfIndices;
		_tmp25__length1 = self->noneOfIndices_length1;
		if (_tmp25_ != NULL) {
			const gchar* _tmp26_ = NULL;
			gchar* _tmp27_ = NULL;
			const gchar* _tmp28_ = NULL;
			gint* _tmp29_ = NULL;
			gint _tmp29__length1 = 0;
			gchar* _tmp30_ = NULL;
			gchar* _tmp31_ = NULL;
			gchar* _tmp32_ = NULL;
			const gchar* _tmp33_ = NULL;
			gchar* _tmp34_ = NULL;
			_tmp26_ = sb;
			_tmp27_ = g_strconcat (_tmp26_, ".NoneOf(", NULL);
			_g_free0 (sb);
			sb = _tmp27_;
			_tmp28_ = sb;
			_tmp29_ = self->noneOfIndices;
			_tmp29__length1 = self->noneOfIndices_length1;
			_tmp30_ = entitas_matcher_componentsto_string (_tmp29_, _tmp29__length1);
			_tmp31_ = _tmp30_;
			_tmp32_ = g_strconcat (_tmp28_, _tmp31_, NULL);
			_g_free0 (sb);
			sb = _tmp32_;
			_g_free0 (_tmp31_);
			_tmp33_ = sb;
			_tmp34_ = g_strconcat (_tmp33_, ")", NULL);
			_g_free0 (sb);
			sb = _tmp34_;
		}
		_tmp35_ = sb;
		_tmp36_ = g_strdup (_tmp35_);
		_g_free0 (self->to_stringCache);
		self->to_stringCache = _tmp36_;
		_g_free0 (sb);
	}
	_tmp37_ = self->to_stringCache;
	_tmp38_ = g_strdup (_tmp37_);
	result = _tmp38_;
	return result;
}


gchar* entitas_matcher_componentsto_string (gint* indexArray, int indexArray_length1) {
	gchar* result = NULL;
	gchar* sb = NULL;
	gchar* _tmp0_ = NULL;
	gint* _tmp1_ = NULL;
	gint _tmp1__length1 = 0;
	_tmp0_ = g_strdup ("");
	sb = _tmp0_;
	_tmp1_ = indexArray;
	_tmp1__length1 = indexArray_length1;
	{
		gint* index_collection = NULL;
		gint index_collection_length1 = 0;
		gint _index_collection_size_ = 0;
		gint index_it = 0;
		index_collection = _tmp1_;
		index_collection_length1 = _tmp1__length1;
		for (index_it = 0; index_it < _tmp1__length1; index_it = index_it + 1) {
			gint index = 0;
			index = index_collection[index_it];
			{
				const gchar* _tmp2_ = NULL;
				gint _tmp3_ = 0;
				const gchar* _tmp4_ = NULL;
				gchar* _tmp5_ = NULL;
				_tmp2_ = sb;
				_tmp3_ = index;
				_tmp4_ = ENTITAS_ComponentString[_tmp3_];
				_tmp5_ = g_strconcat (_tmp2_, _tmp4_, NULL);
				_g_free0 (sb);
				sb = _tmp5_;
			}
		}
	}
	result = sb;
	return result;
}


gint* entitas_matcher_listToArray (GList* l, int* result_length1) {
	gint* result = NULL;
	gint size = 0;
	GList* _tmp0_ = NULL;
	gint* a = NULL;
	gint _tmp2_ = 0;
	gint* _tmp3_ = NULL;
	gint a_length1 = 0;
	gint _a_size_ = 0;
	gint i = 0;
	GList* _tmp4_ = NULL;
	gint* _tmp9_ = NULL;
	gint _tmp9__length1 = 0;
	size = 0;
	_tmp0_ = l;
	{
		GList* x_collection = NULL;
		GList* x_it = NULL;
		x_collection = _tmp0_;
		for (x_it = x_collection; x_it != NULL; x_it = x_it->next) {
			gint x = 0;
			x = (gint) ((gintptr) x_it->data);
			{
				gint _tmp1_ = 0;
				_tmp1_ = size;
				size = _tmp1_ + 1;
			}
		}
	}
	_tmp2_ = size;
	_tmp3_ = g_new0 (gint, _tmp2_);
	a = _tmp3_;
	a_length1 = _tmp2_;
	_a_size_ = a_length1;
	i = 0;
	_tmp4_ = l;
	{
		GList* x_collection = NULL;
		GList* x_it = NULL;
		x_collection = _tmp4_;
		for (x_it = x_collection; x_it != NULL; x_it = x_it->next) {
			gint x = 0;
			x = (gint) ((gintptr) x_it->data);
			{
				gint* _tmp5_ = NULL;
				gint _tmp5__length1 = 0;
				gint _tmp6_ = 0;
				gint _tmp7_ = 0;
				gint _tmp8_ = 0;
				_tmp5_ = a;
				_tmp5__length1 = a_length1;
				_tmp6_ = i;
				i = _tmp6_ + 1;
				_tmp7_ = x;
				_tmp5_[_tmp6_] = _tmp7_;
				_tmp8_ = _tmp5_[_tmp6_];
			}
		}
	}
	_tmp9_ = a;
	_tmp9__length1 = a_length1;
	if (result_length1) {
		*result_length1 = _tmp9__length1;
	}
	result = _tmp9_;
	return result;
}


/**
 * Get the set if distinct (non-duplicate) indices from a list
 * @param Array<number> indices
 * @returns Array<number>
 */
gint* entitas_matcher_distinctIndices (gint* indices, int indices_length1, int* result_length1) {
	gint* result = NULL;
	gboolean* indicesSet = NULL;
	gboolean* _tmp0_ = NULL;
	gint indicesSet_length1 = 0;
	gint _indicesSet_size_ = 0;
	GList* _result_ = NULL;
	gint* _tmp1_ = NULL;
	gint _tmp1__length1 = 0;
	GList* _tmp9_ = NULL;
	gint _tmp10_ = 0;
	gint* _tmp11_ = NULL;
	gint* _tmp12_ = NULL;
	gint _tmp12__length1 = 0;
	_tmp0_ = g_new0 (gboolean, 64);
	indicesSet = _tmp0_;
	indicesSet_length1 = 64;
	_indicesSet_size_ = indicesSet_length1;
	_result_ = NULL;
	_tmp1_ = indices;
	_tmp1__length1 = indices_length1;
	{
		gint* index_collection = NULL;
		gint index_collection_length1 = 0;
		gint _index_collection_size_ = 0;
		gint index_it = 0;
		index_collection = _tmp1_;
		index_collection_length1 = _tmp1__length1;
		for (index_it = 0; index_it < _tmp1__length1; index_it = index_it + 1) {
			gint index = 0;
			index = index_collection[index_it];
			{
				gboolean* _tmp2_ = NULL;
				gint _tmp2__length1 = 0;
				gint _tmp3_ = 0;
				gboolean _tmp4_ = FALSE;
				gboolean* _tmp6_ = NULL;
				gint _tmp6__length1 = 0;
				gint _tmp7_ = 0;
				gboolean _tmp8_ = FALSE;
				_tmp2_ = indicesSet;
				_tmp2__length1 = indicesSet_length1;
				_tmp3_ = index;
				_tmp4_ = _tmp2_[_tmp3_];
				if (!_tmp4_) {
					gint _tmp5_ = 0;
					_tmp5_ = index;
					_result_ = g_list_append (_result_, (gpointer) ((gintptr) _tmp5_));
				}
				_tmp6_ = indicesSet;
				_tmp6__length1 = indicesSet_length1;
				_tmp7_ = index;
				_tmp6_[_tmp7_] = TRUE;
				_tmp8_ = _tmp6_[_tmp7_];
			}
		}
	}
	_tmp9_ = _result_;
	_tmp11_ = entitas_matcher_listToArray (_tmp9_, &_tmp10_);
	_tmp12_ = _tmp11_;
	_tmp12__length1 = _tmp10_;
	if (result_length1) {
		*result_length1 = _tmp12__length1;
	}
	result = _tmp12_;
	_g_list_free0 (_result_);
	indicesSet = (g_free (indicesSet), NULL);
	return result;
}


/**
 * Merge all the indices of a set of Matchers
 * @param Array<IMatcher> matchers
 * @returns Array<number>
 */
gint* entitas_matcher_merge (entitasMatcher** matchers, int matchers_length1, int* result_length1, GError** error) {
	gint* result = NULL;
	GList* indices = NULL;
	GList* _tmp19_ = NULL;
	gint _tmp20_ = 0;
	gint* _tmp21_ = NULL;
	gint* _tmp22_ = NULL;
	gint _tmp22__length1 = 0;
	GError * _inner_error_ = NULL;
	indices = NULL;
	{
		gint i = 0;
		i = 0;
		{
			gboolean _tmp0_ = FALSE;
			_tmp0_ = TRUE;
			while (TRUE) {
				entitasMatcher** _tmp2_ = NULL;
				gint _tmp2__length1 = 0;
				entitasMatcher** _tmp3_ = NULL;
				gint _tmp3__length1 = 0;
				gint _tmp4_ = 0;
				entitasMatcher* _tmp5_ = NULL;
				gint* _tmp6_ = NULL;
				gint _tmp6__length1 = 0;
				entitasMatcher** _tmp14_ = NULL;
				gint _tmp14__length1 = 0;
				gint _tmp15_ = 0;
				entitasMatcher* _tmp16_ = NULL;
				gint* _tmp17_ = NULL;
				gint _tmp17__length1 = 0;
				gint _tmp18_ = 0;
				if (!_tmp0_) {
					gint _tmp1_ = 0;
					_tmp1_ = i;
					i = _tmp1_ + 1;
				}
				_tmp0_ = FALSE;
				_tmp2_ = matchers;
				_tmp2__length1 = matchers_length1;
				if (!(i <= (_tmp2__length1 - 1))) {
					break;
				}
				_tmp3_ = matchers;
				_tmp3__length1 = matchers_length1;
				_tmp4_ = i;
				_tmp5_ = _tmp3_[_tmp4_];
				_tmp6_ = _tmp5_->indices;
				_tmp6__length1 = _tmp5_->indices_length1;
				if (_tmp6__length1 != 1) {
					entitasMatcher** _tmp7_ = NULL;
					gint _tmp7__length1 = 0;
					gint _tmp8_ = 0;
					entitasMatcher* _tmp9_ = NULL;
					gchar* _tmp10_ = NULL;
					gchar* _tmp11_ = NULL;
					GError* _tmp12_ = NULL;
					GError* _tmp13_ = NULL;
					_tmp7_ = matchers;
					_tmp7__length1 = matchers_length1;
					_tmp8_ = i;
					_tmp9_ = _tmp7_[_tmp8_];
					_tmp10_ = entitas_matcher_to_string (_tmp9_);
					_tmp11_ = _tmp10_;
					_tmp12_ = g_error_new_literal (ENTITAS_EXCEPTION, ENTITAS_EXCEPTION_InvalidMatcherExpression, _tmp11_);
					_tmp13_ = _tmp12_;
					_g_free0 (_tmp11_);
					_inner_error_ = _tmp13_;
					if (_inner_error_->domain == ENTITAS_EXCEPTION) {
						g_propagate_error (error, _inner_error_);
						_g_list_free0 (indices);
						return NULL;
					} else {
						_g_list_free0 (indices);
						g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
						g_clear_error (&_inner_error_);
						return NULL;
					}
				}
				_tmp14_ = matchers;
				_tmp14__length1 = matchers_length1;
				_tmp15_ = i;
				_tmp16_ = _tmp14_[_tmp15_];
				_tmp17_ = _tmp16_->indices;
				_tmp17__length1 = _tmp16_->indices_length1;
				_tmp18_ = _tmp17_[0];
				indices = g_list_append (indices, (gpointer) ((gintptr) _tmp18_));
			}
		}
	}
	_tmp19_ = indices;
	_tmp21_ = entitas_matcher_listToArray (_tmp19_, &_tmp20_);
	_tmp22_ = _tmp21_;
	_tmp22__length1 = _tmp20_;
	if (result_length1) {
		*result_length1 = _tmp22__length1;
	}
	result = _tmp22_;
	_g_list_free0 (indices);
	return result;
}


/**
 * Matches noneOf the components/indices specified
 * @params Array<entitas.IMatcher>|Array<number> args
 * @returns entitas.Matcher
 */
entitasMatcher* entitas_matcher_NoneOf (gint* args, int args_length1) {
	entitasMatcher* result = NULL;
	entitasMatcher* matcher = NULL;
	entitasMatcher* _tmp0_ = NULL;
	gint* _tmp1_ = NULL;
	gint _tmp1__length1 = 0;
	gint _tmp2_ = 0;
	gint* _tmp3_ = NULL;
	gint* _tmp4_ = NULL;
	gint _tmp4__length1 = 0;
	guint64 _tmp5_ = 0ULL;
	_tmp0_ = entitas_matcher_new (NULL, 0);
	matcher = _tmp0_;
	_tmp1_ = args;
	_tmp1__length1 = args_length1;
	_tmp3_ = entitas_matcher_distinctIndices (_tmp1_, _tmp1__length1, &_tmp2_);
	matcher->noneOfIndices = (g_free (matcher->noneOfIndices), NULL);
	matcher->noneOfIndices = _tmp3_;
	matcher->noneOfIndices_length1 = _tmp2_;
	_tmp4_ = matcher->noneOfIndices;
	_tmp4__length1 = matcher->noneOfIndices_length1;
	_tmp5_ = entitas_matcher_buildMask (_tmp4_, _tmp4__length1);
	matcher->noneOfMask = _tmp5_;
	result = matcher;
	return result;
}


/**
 * Matches allOf the components/indices specified
 * @params Array<entitas.IMatcher>|Array<number> args
 * @returns entitas.Matcher
 */
entitasMatcher* entitas_matcher_AllOf (gint* args, int args_length1) {
	entitasMatcher* result = NULL;
	entitasMatcher* matcher = NULL;
	entitasMatcher* _tmp0_ = NULL;
	gint* _tmp1_ = NULL;
	gint _tmp1__length1 = 0;
	gint _tmp2_ = 0;
	gint* _tmp3_ = NULL;
	gint* _tmp4_ = NULL;
	gint _tmp4__length1 = 0;
	guint64 _tmp5_ = 0ULL;
	_tmp0_ = entitas_matcher_new (NULL, 0);
	matcher = _tmp0_;
	_tmp1_ = args;
	_tmp1__length1 = args_length1;
	_tmp3_ = entitas_matcher_distinctIndices (_tmp1_, _tmp1__length1, &_tmp2_);
	matcher->allOfIndices = (g_free (matcher->allOfIndices), NULL);
	matcher->allOfIndices = _tmp3_;
	matcher->allOfIndices_length1 = _tmp2_;
	_tmp4_ = matcher->allOfIndices;
	_tmp4__length1 = matcher->allOfIndices_length1;
	_tmp5_ = entitas_matcher_buildMask (_tmp4_, _tmp4__length1);
	matcher->allOfMask = _tmp5_;
	result = matcher;
	return result;
}


/**
 * Matches anyOf the components/indices specified
 * @params Array<entitas.IMatcher>|Array<number> args
 * @returns entitas.Matcher
 */
entitasMatcher* entitas_matcher_AnyOf (gint* args, int args_length1) {
	entitasMatcher* result = NULL;
	entitasMatcher* matcher = NULL;
	entitasMatcher* _tmp0_ = NULL;
	gint* _tmp1_ = NULL;
	gint _tmp1__length1 = 0;
	gint _tmp2_ = 0;
	gint* _tmp3_ = NULL;
	gint* _tmp4_ = NULL;
	gint _tmp4__length1 = 0;
	guint64 _tmp5_ = 0ULL;
	_tmp0_ = entitas_matcher_new (NULL, 0);
	matcher = _tmp0_;
	_tmp1_ = args;
	_tmp1__length1 = args_length1;
	_tmp3_ = entitas_matcher_distinctIndices (_tmp1_, _tmp1__length1, &_tmp2_);
	matcher->anyOfIndices = (g_free (matcher->anyOfIndices), NULL);
	matcher->anyOfIndices = _tmp3_;
	matcher->anyOfIndices_length1 = _tmp2_;
	_tmp4_ = matcher->anyOfIndices;
	_tmp4__length1 = matcher->anyOfIndices_length1;
	_tmp5_ = entitas_matcher_buildMask (_tmp4_, _tmp4__length1);
	matcher->anyOfMask = _tmp5_;
	result = matcher;
	return result;
}


guint64 entitas_matcher_buildMask (gint* indices, int indices_length1) {
	guint64 result = 0ULL;
	guint64 accume = 0ULL;
	gint* _tmp0_ = NULL;
	gint _tmp0__length1 = 0;
	accume = (guint64) 0;
	_tmp0_ = indices;
	_tmp0__length1 = indices_length1;
	{
		gint* index_collection = NULL;
		gint index_collection_length1 = 0;
		gint _index_collection_size_ = 0;
		gint index_it = 0;
		index_collection = _tmp0_;
		index_collection_length1 = _tmp0__length1;
		for (index_it = 0; index_it < _tmp0__length1; index_it = index_it + 1) {
			gint index = 0;
			index = index_collection[index_it];
			{
				guint64 _tmp1_ = 0ULL;
				gint _tmp2_ = 0;
				guint64 _tmp3_ = 0ULL;
				_tmp1_ = accume;
				_tmp2_ = index;
				_tmp3_ = ENTITAS___POW2__[_tmp2_];
				accume = _tmp1_ | _tmp3_;
			}
		}
	}
	result = accume;
	return result;
}


static void entitas_matcher_instance_init (entitasMatcher * self) {
}


void entitas_matcher_free (entitasMatcher* self) {
	_g_free0 (self->id);
	self->allOfIndices = (g_free (self->allOfIndices), NULL);
	self->anyOfIndices = (g_free (self->anyOfIndices), NULL);
	self->noneOfIndices = (g_free (self->noneOfIndices), NULL);
	self->indices = (g_free (self->indices), NULL);
	_g_free0 (self->to_stringCache);
	g_slice_free (entitasMatcher, self);
}



